<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LMS –®–∫–æ–ª–∞ - –í—Ö–æ–¥</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/x-icon" href="assets/favicon.ico">
    <style>
        .login-container {
            max-width: 400px;
            margin: 100px auto;
            padding: 40px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
        .login-title {
            text-align: center;
            margin-bottom: 30px;
            color: #2c3e50;
        }
        .form-group {
            margin-bottom: 20px;
        }
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
        }
        .form-control {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }
        .role-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        .role-btn {
            flex: 1;
            padding: 10px;
            border: 2px solid #ddd;
            background: white;
            border-radius: 5px;
            cursor: pointer;
            text-align: center;
        }
        .role-btn.active {
            border-color: #3498db;
            background: #3498db;
            color: white;
        }
        .error-message {
            color: #e74c3c;
            margin-top: 10px;
            display: none;
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="container">
            <div class="header-inner">
                <div class="logo">
                    <img src="assets/logo.png" alt="–õ–æ–≥–æ—Ç–∏–ø" class="logo-img">
                    <div class="logo-text">
                        <span class="logo-name">LMS –®–∫–æ–ª–∞</span>
                        <span class="logo-subtitle">school-krd.online</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <main class="container">
        <div class="login-container">
            <h2 class="login-title">–í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É</h2>
            
            <div class="role-selector">
                <div class="role-btn active" data-role="student">–£—á–µ–Ω–∏–∫</div>
                <div class="role-btn" data-role="teacher">–£—á–∏—Ç–µ–ª—å</div>
            </div>
            
            <form id="loginForm">
                <div class="form-group">
                    <label for="email">Email</label>
                    <input type="email" id="email" class="form-control" placeholder="vasya@school.ru" required>
                </div>
                
                <div class="form-group">
                    <label for="password">–ü–∞—Ä–æ–ª—å</label>
                    <input type="password" id="password" class="form-control" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å" required>
                </div>
                
                <button type="submit" class="btn btn-primary" style="width: 100%;">
                    –í–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É
                </button>
                
                <div id="errorMessage" class="error-message">
                    –ù–µ–≤–µ—Ä–Ω—ã–π email –∏–ª–∏ –ø–∞—Ä–æ–ª—å
                </div>
            </form>
            
            <div style="margin-top: 20px; text-align: center;">
                <small>–î–ª—è —Ç–µ—Å—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:<br>
                –£—á–µ–Ω–∏–∫: student@school.ru / 123<br>
                –£—á–∏—Ç–µ–ª—å: teacher@school.ru / 456</small>
            </div>
        </div>
    </main>

    <script src="js/supabase-config.js"></script>
    <script src="js/auth.js"></script>

    <script>
        // –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            console.log('=== LMS DEBUG INFO ===');
            console.log('Supabase URL:', supabase.supabaseUrl);
            console.log('LocalStorage user:', localStorage.getItem('user'));
            
            // –¢–µ—Å—Ç–æ–≤—ã–π –≤—Ö–æ–¥ –≤ –∫–æ–Ω—Å–æ–ª–∏
            window.testLogin = async function() {
                const testEmail = 'student@school.ru';
                const testPass = '123';
                
                console.log('üß™ –¢–µ—Å—Ç–æ–≤—ã–π –≤—Ö–æ–¥:', testEmail);
                
                const { data, error } = await supabase
                    .from('users')
                    .select('*')
                    .eq('email', testEmail)
                    .eq('password', testPass)
                    .single();
                
                console.log('–†–µ–∑—É–ª—å—Ç–∞—Ç:', { data, error });
                
                if (data) {
                    console.log('‚úÖ –£—Å–ø–µ—Ö! –ú–æ–∂–Ω–æ –≤–æ–π—Ç–∏ —Å —ç—Ç–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏');
                    return data;
                } else {
                    console.log('‚ùå –û—à–∏–±–∫–∞:', error);
                    return null;
                }
            };
            
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            setTimeout(() => {
                console.log('–ü—Ä–æ–≤–µ—Ä—è—é —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è...');
                window.testLogin();
            }, 1000);
        });
        </script>
</body>
</html>