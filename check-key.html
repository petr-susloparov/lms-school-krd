<!DOCTYPE html>
<html>
<head>
    <title>–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–ª—é—á–∞ Supabase</title>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <style>
        body { font-family: Arial; padding: 20px; max-width: 800px; margin: auto; }
        .card { background: white; padding: 20px; margin: 15px 0; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .success { color: green; }
        .error { color: red; }
        .warning { color: orange; }
        pre { background: #f5f5f5; padding: 10px; overflow: auto; font-size: 12px; }
        input, button { padding: 10px; margin: 5px; }
    </style>
</head>
<body>
    <h1>üîë –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–ª—é—á–∞ Supabase</h1>
    
    <div class="card">
        <h3>1. –í–≤–µ–¥–∏—Ç–µ –≤–∞—à –∫–ª—é—á:</h3>
        <input type="text" id="keyInput" placeholder="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..." 
               style="width: 100%; padding: 10px; margin-bottom: 10px;">
        <button onclick="testKey()" style="background: #3498db; color: white; border: none; padding: 10px 20px;">
            –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–ª—é—á
        </button>
    </div>
    
    <div class="card">
        <h3>2. –†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏:</h3>
        <div id="result"></div>
    </div>
    
    <div class="card">
        <h3>3. –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:</h3>
        <ol>
            <li>–ó–∞–π–¥–∏—Ç–µ –≤ <a href="https://app.supabase.com" target="_blank">Supabase Dashboard</a></li>
            <li>–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç <code>potnqqwsaxnrrnuhoysb</code></li>
            <li>–ù–∞–∂–º–∏—Ç–µ ‚öôÔ∏è <strong>Settings</strong> ‚Üí <strong>API</strong></li>
            <li>–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–ª—é—á –∏–∑ –ø–æ–ª—è <strong>"anon public"</strong></li>
            <li>–í—Å—Ç–∞–≤—å—Ç–µ –∫–ª—é—á –≤—ã—à–µ –∏ –Ω–∞–∂–º–∏—Ç–µ "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–ª—é—á"</li>
            <li>–ï—Å–ª–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–π–¥–µ–Ω–∞, —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–ª—é—á –≤ —Ñ–∞–π–ª <code>js/supabase-client.js</code></li>
        </ol>
        
        <p><strong>–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –∫–ª—é—á–∞:</strong></p>
        <pre>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBvdG5xcXdzYXhucnJudWhveXNiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzU1NjQ0MDAsImV4cCI6MjA1MTE0MDQwMH0.9e4f0c8a2b5c3d7e8f9a0b1c2d3e4f5a6b7c8d9e0f1a2b3c4d5e6f7a8b9c0d1e</pre>
        
        <p><strong>–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç (—Å—Ç–∞—Ä—ã–π):</strong></p>
        <pre>sb_publishable_3MylWTVrctgP1TxRy_ykSw_PlOlO23l</pre>
    </div>

    <script>
    async function testKey() {
        const key = document.getElementById('keyInput').value.trim();
        const resultDiv = document.getElementById('result');
        
        if (!key) {
            resultDiv.innerHTML = '<p class="error">‚ùå –í–≤–µ–¥–∏—Ç–µ –∫–ª—é—á</p>';
            return;
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞
        const isJWT = /^eyJ[a-zA-Z0-9_-]+\.[a-zA-Z0-9_-]+\.[a-zA-Z0-9_-]+$/.test(key);
        
        if (!isJWT) {
            resultDiv.innerHTML = `
                <p class="error">‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –∫–ª—é—á–∞</p>
                <p>–í–∞—à –∫–ª—é—á –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å JWT —Ç–æ–∫–µ–Ω–æ–º (–Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å eyJ...)</p>
                <p>–î–ª–∏–Ω–∞ –≤–∞—à–µ–≥–æ –∫–ª—é—á–∞: ${key.length} —Å–∏–º–≤–æ–ª–æ–≤</p>
                <p>–í—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ —Å—Ç–∞—Ä—ã–π —Ñ–æ—Ä–º–∞—Ç –∫–ª—é—á–∞. –ü–æ–ª—É—á–∏—Ç–µ –Ω–æ–≤—ã–π –≤ Dashboard.</p>
            `;
            return;
        }
        
        resultDiv.innerHTML = '<p>‚è≥ –ü—Ä–æ–≤–µ—Ä—è—é –∫–ª—é—á...</p>';
        
        try {
            // –ü—Ä–æ–±—É–µ–º —Å–æ–∑–¥–∞—Ç—å –∫–ª–∏–µ–Ω—Ç
            const supabaseTest = window.supabase.createClient(
                'https://potnqqwsaxnrrnuhoysb.supabase.co',
                key,
                {
                    auth: { persistSession: false }
                }
            );
            
            // –ü—Ä–æ–±—É–µ–º –∑–∞–ø—Ä–æ—Å
            const { data, error } = await supabaseTest
                .from('users')
                .select('count')
                .limit(1);
            
            if (error) {
                resultDiv.innerHTML = `
                    <p class="error">‚ùå –ö–ª—é—á –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç</p>
                    <p>–û—à–∏–±–∫–∞: ${error.message}</p>
                    <p>–ö–æ–¥ –æ—à–∏–±–∫–∏: ${error.code || '–Ω–µ—Ç'}</p>
                `;
            } else {
                resultDiv.innerHTML = `
                    <p class="success">‚úÖ –ö–ª—é—á —Ä–∞–±–æ—Ç–∞–µ—Ç!</p>
                    <p>–ö–ª—é—á –≤–∞–ª–∏–¥–Ω—ã–π, –¥–ª–∏–Ω–∞: ${key.length} —Å–∏–º–≤–æ–ª–æ–≤</p>
                    <p>–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î: –£–°–ü–ï–•</p>
                    <p><strong>–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —ç—Ç–æ—Ç –∫–ª—é—á –≤ —Ñ–∞–π–ª <code>js/supabase-client.js</code>:</strong></p>
                    <pre style="background: #e8f5e8;">const SUPABASE_ANON_KEY = '${key}';</pre>
                    <button onclick="copyToClipboard('${key}')" style="background: #2ecc71; color: white; padding: 10px; border: none; border-radius: 5px;">
                        üìã –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–ª—é—á
                    </button>
                `;
            }
            
        } catch (error) {
            resultDiv.innerHTML = `
                <p class="error">üí• –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞</p>
                <p>${error.message}</p>
                <p>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ Supabase Dashboard ‚Üí Settings ‚Üí API</p>
            `;
        }
    }
    
    function copyToClipboard(text) {
        navigator.clipboard.writeText(text).then(() => {
            alert('‚úÖ –ö–ª—é—á —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞');
        });
    }
    
    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º —Ç–µ–∫—É—â–∏–π –∫–ª—é—á –∏–∑ localStorage
    document.addEventListener('DOMContentLoaded', () => {
        const savedKey = localStorage.getItem('last_supabase_key');
        if (savedKey) {
            document.getElementById('keyInput').value = savedKey;
        }
    });
    </script>
</body>
</html>